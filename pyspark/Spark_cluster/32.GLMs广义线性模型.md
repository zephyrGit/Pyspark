
1. 在线性回归中，我们假定数据集分布的误差项服从的是标准得正态分布（高斯分布），实际上误差项得分布不一定是服从高斯分布的，还可能服从泊松分布、伽马分布等。而因此线性模型实际上是一个广义的概念，误差项得分布有很多可能得分布模型，不同的分布模型对不同的数据类型生效，实际上GLM是一个算法家族，每个算法都有可选的连接函数可以选择，带星的是对剑的连接函数  

2. 广义线性模型是一个大的研究方向，更多的资料详细查看：[广义线性模型](https://baike.baidu.com/item/%E5%B9%BF%E4%B9%89%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B/8465894?fr=aladdin)  
广义线性模型可用的算法家族如下：  

Family | Response Type | Supported <font color='red'>Links</font>
-|-|-
Gqussian | Continuous | Identity*, Log, Inverse  
Binomial | Binary | Logit*, Probit, CLogLog 
Poisson | Count | Log*, Identity, Sqrt
Gamma | Continuous | Inverse*, Idenity, Log
Twwedie | Zero-inflated continuous | Power link function
* <font face='微软雅黑'>Cannoical Link</font>

3. 使用GLM广义线性模型预测房屋价格 

~~~python

from pyspark.sql import SparkSession
from pyspark.ml.regression import GeneralizedLinearRegression
from pyspark.ml.linalg import Vectors
from pyspark.ml.feature import VectorAssembler

spark = SparkSession.builder.master('local').appName('GLM').getOrCreate()
df = spark.read.csv('/data/mllib/house_data.csv', header=True)
datas = df.select(df.price.cast('double'), df.bedrooms.cast('double'),
                  df.bathrooms.cast('double'), df.sqft_living.cast('double'),
                  df.floors.cast('double'))
assembler = VectorAssembler(
    inputCols=['sqft_living', 'bedrooms', 'bathrooms', 'floors'],
    outputCol='features')
output = assembler.transform(datas)
label_features = output.select('features', 'price').toDF('features', 'label')
label_features.show(truncate=False)
>>> 
+---------------------+---------+
|features             |label    |
+---------------------+---------+
|[1180.0,3.0,1.0,1.0] |221900.0 |
|[2570.0,3.0,2.25,2.0]|538000.0 |
|[770.0,2.0,1.0,1.0]  |180000.0 |
|[1960.0,4.0,3.0,1.0] |604000.0 |
|[1680.0,3.0,2.0,1.0] |510000.0 |
|[5420.0,4.0,4.5,1.0] |1230000.0|
|[1715.0,3.0,2.25,2.0]|257500.0 |
|[1060.0,3.0,1.5,1.0] |291850.0 |
|[1780.0,3.0,1.0,1.0] |229500.0 |
|[1890.0,3.0,2.5,2.0] |323000.0 |
|[3560.0,3.0,2.5,1.0] |662500.0 |
|[1160.0,2.0,1.0,1.0] |468000.0 |
|[1430.0,3.0,1.0,1.5] |310000.0 |
|[1370.0,3.0,1.75,1.0]|400000.0 |
|[1810.0,5.0,2.0,1.5] |530000.0 |
|[2950.0,4.0,3.0,2.0] |650000.0 |
|[1890.0,3.0,2.0,2.0] |395000.0 |
|[1600.0,4.0,1.0,1.5] |485000.0 |
|[1200.0,2.0,1.0,1.0] |189000.0 |
|[1250.0,3.0,1.0,1.0] |230000.0 |
+---------------------+---------+
only showing top 20 rows

glr = GeneralizedLinearRegression(family='gaussian',
                                  link='identity',
                                  maxIter=10,
                                  regParam=0.3)
model = glr.fit(label_features)
model.transform(label_features)
>>> DataFrame[features: vector, label: double, prediction: double]

print('Coefficients:' + str(model.coefficients))
print('Intercept:' + str(model.intercept))
>>> 
Coefficients:[309.604882237,-57893.8914492,7852.61973671,193.805285028]
Intercept:74490.1948373642

summary = model.summary
print('Coefficient Standard Errors:' + str(summary.coefficientStandardErrors))
print('T Values:' + str(summary.tValues))
print('P Values:' + str(summary.pValues))
print('Dispersion:' + str(summary.dispersion))
print('Null Deviance:' + str(summary.nullDeviance))
print('Residual Degree Of Freedom Null:' +
      str(summary.residualDegreeOfFreedomNull))
print('Deviance:' + str(summary.deviance))
print('Residual Degree Of Freedom:' + str(summary.residualDegreeOfFreedom))
print('AIC:' + str(summary.aic))
print('Deviance Residuals:')
summary.residuals().show()
>>> 
Coefficient Standard Errors:[3.088810406161417, 2348.784727293341, 3816.594426883076, 3777.8559877979733, 7683.90561285486]
T Values:[100.2343431696833, -24.64844511992716, 2.0574938959715174, 0.05130033692498675, 9.694314140551798]
P Values:[0.0, 0.0, 0.03965071288444788, 0.9590866738228851, 0.0]
Dispersion:66553713643.20163
Null Deviance:2916647660836786.5
Residual Degree Of Freedom Null:21612
Deviance:1438092644402300.8
Residual Degree Of Freedom:21608
AIC:599965.5569779396
Deviance Residuals:
+-------------------+
|  devianceResiduals|
+-------------------+
| -52288.70655144553|
|-176549.07281717076|
|-25144.596283376857|
| 130508.13727927348|
|  73156.23259320745|
|-326503.68486675504|
|-192336.89850430284|
|  50887.56944867177|
|-230451.63589380885|
|-182980.90783000324|
|-360327.25588121964|
| 142109.49964408693|
| -41686.82975327765|
|  61096.90102093964|
| 168598.47815827408|
|-130194.50142065436|
|-107054.59796164784|
| 138574.23171559907|
|-149274.69564540393|
| -65861.04830805457|
+-------------------+
only showing top 20 rows
~~~
